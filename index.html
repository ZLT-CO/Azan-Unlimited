<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Azan Unlimited</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    font-family:'Inter',sans-serif;
    background:linear-gradient(135deg,#0f1117,#121826);
    color:white;
}

header{
    padding:20px 30px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    backdrop-filter:blur(10px);
    background:rgba(0,0,0,0.4);
}

h1{
    margin:0;
    font-weight:700;
    letter-spacing:1px;
}

button{
    cursor:pointer;
}

.main{
    padding:40px 20px;
    display:flex;
    flex-direction:column;
    align-items:center;
}

.card{
    width:100%;
    max-width:420px;
    background:rgba(27,94,32,0.7);
    backdrop-filter:blur(20px);
    border-radius:20px;
    padding:25px;
    margin-bottom:20px;
    box-shadow:0 10px 40px rgba(0,200,83,0.4);
    transition:.3s;
}

.card:hover{
    transform:translateY(-5px);
    box-shadow:0 15px 50px rgba(0,200,83,0.7);
}

.card h2{
    margin:0;
    font-size:1.6rem;
}

.time{
    font-size:1.3rem;
    color:#ddd;
    margin:8px 0 15px 0;
}

.btn{
    background:#66bb6a;
    border:none;
    padding:10px 20px;
    border-radius:12px;
    font-weight:600;
    color:white;
}

.settings{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:rgba(20,40,20,0.95);
    backdrop-filter:blur(25px);
    padding:30px;
    border-radius:20px;
    width:320px;
    box-shadow:0 0 50px rgba(0,200,83,0.7);
}

.settings h2{
    margin-top:0;
}

.settings label{
    display:block;
    margin-top:12px;
    font-size:0.9rem;
}

.hidden{
    display:none;
}

footer{
    text-align:center;
    padding:30px;
    color:#666;
}
</style>
</head>
<body>

<header>
<h1>Azan Unlimited</h1>
<button class="btn" onclick="toggleSettings()">Settings</button>
</header>

<div class="main" id="prayers"></div>

<div id="settingsPanel" class="settings hidden">
<h2>Settings</h2>

<label>Reciter</label>
<select id="reciterSelect"></select>

<h3 style="margin-top:20px;">Notifications</h3>

<div id="notifControls"></div>

<button class="btn" style="margin-top:20px;" onclick="toggleSettings()">Close</button>
</div>

<footer>Â© 2026 ZLT Co.</footer>

<script>

// ===== CONFIG =====
const reciters={
mishary:{name:"Mishary Rashid",file:"mishary.mp3"},
saad:{name:"Saad Al-Ghamdi",file:"saad.mp3"},
maher:{name:"Maher Al-Muaiqly",file:"maher.mp3"},
sudais:{name:"Sudais",file:"sudais.mp3"}
};

const allowedPrayers=["Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];

let selectedReciter="mishary";
let prayerTimes={};
let notifications={};

// ===== INIT =====
document.addEventListener("DOMContentLoaded",()=>{
loadReciters();
loadNotificationSettings();
getLocation();
});

// ===== UI =====
function toggleSettings(){
document.getElementById("settingsPanel").classList.toggle("hidden");
}

function loadReciters(){
const select=document.getElementById("reciterSelect");
select.innerHTML="";

for(const key in reciters){
const option=document.createElement("option");
option.value=key;
option.textContent=reciters[key].name;
select.appendChild(option);
}

selectedReciter=localStorage.getItem("reciter")||"mishary";
select.value=selectedReciter;

select.addEventListener("change",function(){
selectedReciter=this.value;
localStorage.setItem("reciter",selectedReciter);
});
}

function loadNotificationSettings(){
const container=document.getElementById("notifControls");
container.innerHTML="";

allowedPrayers.forEach(prayer=>{
if(localStorage.getItem("notif_"+prayer)===null){
localStorage.setItem("notif_"+prayer,"true");
}
notifications[prayer]=localStorage.getItem("notif_"+prayer")==="true";

const label=document.createElement("label");
label.innerHTML=`
<input type="checkbox" id="toggle_${prayer}" ${notifications[prayer]?"checked":""}>
 ${prayer}
`;
container.appendChild(label);

document.getElementById("toggle_"+prayer).addEventListener("change",function(){
notifications[prayer]=this.checked;
localStorage.setItem("notif_"+prayer,this.checked);
});
});
}

// ===== FETCH LOCATION =====
function getLocation(){
navigator.geolocation.getCurrentPosition(async(pos)=>{
const lat=pos.coords.latitude;
const lon=pos.coords.longitude;

const res=await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`);
const data=await res.json();
prayerTimes=data.data.timings;

renderPrayers();
scheduleNotifications();
});
}

// ===== RENDER =====
function renderPrayers(){
const container=document.getElementById("prayers");
container.innerHTML="";

allowedPrayers.forEach(prayer=>{
const time=prayerTimes[prayer];
if(!time) return;

const card=document.createElement("div");
card.className="card";

card.innerHTML=`
<h2>${prayer}</h2>
<div class="time">${time}</div>
<button class="btn">Play Adhan</button>
`;

card.querySelector("button").onclick=playAdhan;
container.appendChild(card);
});
}

// ===== AUDIO =====
function playAdhan(){
const audio=new Audio(reciters[selectedReciter].file);
audio.play();
}

// ===== NOTIFICATIONS =====
function scheduleNotifications(){

if(Notification.permission!=="granted"){
Notification.requestPermission();
}

const now=new Date();

allowedPrayers.forEach(prayer=>{
if(!notifications[prayer]) return;

const time=prayerTimes[prayer];
if(!time) return;

const [hour,minute]=time.split(":").map(Number);

const notifTime=new Date();
notifTime.setHours(hour,minute,0,0);

if(notifTime<=now) return;

const timeout=notifTime-now;

setTimeout(()=>{
new Notification(`Time for ${prayer}`);
playAdhan();
},timeout);

});
}

</script>

</body>
</html>
