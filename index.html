<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Azan Unlimited</title>

<link rel="icon" href="favicon.ico">
<link rel="manifest" href="manifest.json">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
font-family:'Inter',sans-serif;
background:linear-gradient(135deg,#0f1117,#1b2a1f);
color:white;
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
}

header{
padding:30px;
font-size:1.8rem;
font-weight:700;
}

#countdown{
font-size:1.2rem;
margin-bottom:20px;
color:#66bb6a;
}

.prayer-list{
width:100%;
max-width:500px;
}

.prayer-row{
display:flex;
justify-content:space-between;
padding:18px 25px;
margin:8px 0;
background:rgba(27,94,32,0.7);
border-radius:15px;
transition:.3s;
}

.prayer-row.active{
background:#00c853;
color:black;
font-weight:700;
}

footer{
margin-top:auto;
padding:20px;
color:#888;
font-size:0.8rem;
}
</style>
</head>
<body>

<header>Azan Unlimited</header>
<div id="countdown">Loading prayer times...</div>

<div class="prayer-list" id="prayerList"></div>

<footer>Â© 2026 ZLT Co.</footer>

<script>

const allowed=["Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];
let prayerTimes={};

async function init(){
try{
const coords=await getCoords();
await fetchTimes(coords.lat,coords.lon);
render();
startCountdown();
}catch(e){
document.getElementById("countdown").innerText="Could not load prayer times.";
console.error(e);
}
}

function getCoords(){
return new Promise((resolve)=>{
navigator.geolocation.getCurrentPosition(
pos=>resolve({lat:pos.coords.latitude,lon:pos.coords.longitude}),
()=>resolve({lat:40.7128,lon:-74.0060}) // fallback NYC
);
});
}

async function fetchTimes(lat,lon){
const res=await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`);
const data=await res.json();
prayerTimes=data.data.timings;
}

function render(){
const container=document.getElementById("prayerList");
container.innerHTML="";

allowed.forEach(name=>{
if(!prayerTimes[name]) return;

const row=document.createElement("div");
row.className="prayer-row";
row.id="row_"+name;

row.innerHTML=`<div>${name}</div><div>${prayerTimes[name]}</div>`;
container.appendChild(row);
});
highlightNext();
}

function highlightNext(){
const now=new Date();

for(let name of allowed){
if(!prayerTimes[name]) continue;
const [h,m]=prayerTimes[name].split(":").map(Number);
const t=new Date();
t.setHours(h,m,0,0);
if(t>now){
document.getElementById("row_"+name)?.classList.add("active");
break;
}
}
}

function startCountdown(){
setInterval(()=>{
const now=new Date();

for(let name of allowed){
if(!prayerTimes[name]) continue;
const [h,m]=prayerTimes[name].split(":").map(Number);
const t=new Date();
t.setHours(h,m,0,0);
if(t>now){
const diff=t-now;
const hrs=Math.floor(diff/3600000);
const mins=Math.floor((diff%3600000)/60000);
const secs=Math.floor((diff%60000)/1000);
document.getElementById("countdown").innerText=
`Next: ${name} in ${hrs}h ${mins}m ${secs}s`;
break;
}
}
},1000);
}

init();

</script>

</body>
</html>
